<html>

<head>
  <style>
    #container{
      min-height: 50%;
      max-width: 50%;
    }

    .hidden{
      display: none;
    }

    body, html{
      height: 100%;
      width: 100%;
      margin: 0;
    }

    .hidable {
      display: none;
    }

    .hover{
      display: inline;
    }

    .full{
      width: 100%;
      height: 100%;
      margin : 0;
    }
  </style>
  
  <script>
    var DEFAULT_PERCENT = 25;
    var PERCENT_STEP = 0.1;

    var DEFAULT_X = 0;
    var DEFAULT_Y = 0;

    var DEFAULT_DX = 1;
    var DEFAULT_DY = 2;

    // Position for x,y.
    var x = DEFAULT_X;
    var y = DEFAULT_Y;

    // every dt ms translate the backgrounds x by dx and y by dy.
    var dx = DEFAULT_DX; 
    var dy = DEFAULT_DY;
    var dt = 20; 

    var container;
    var rawr;
    var overlay;

    var tracking;

    var gif_index = 0;
    var overlay_index = 0;

    var GIF_URLS = [
      "http://31.media.tumblr.com/37b83fc62c74feca10eabdd949db2e09/tumblr_mzq5d8uiFD1six59bo1_400.gif",
      "http://25.media.tumblr.com/761e32af86895cf7c1be483932bc5a71/tumblr_mvrw6iuSHS1rilp8po1_500.gif",
      "http://31.media.tumblr.com/cdad06a09d2a180fc1138d6cade190b7/tumblr_mvwfotFHgX1rilp8po1_500.gif",
      "http://25.media.tumblr.com/fb94197e2f8f47366b5ccf3309122fa6/tumblr_mzre7ufgqq1sso6sco1_500.gif",
      "http://31.media.tumblr.com/761037ef4d5f78adda24ca6dd0175eac/tumblr_mzdp4uLeBF1rilp8po1_500.gif",
      "http://31.media.tumblr.com/217415631a8b6aa999a100c2d0bc0cb7/tumblr_myyii2w2v01rilp8po1_500.gif",
      "http://31.media.tumblr.com/a31a91541758b95ea81907b7539f4ff9/tumblr_mryp2oe4UB1qfjvexo1_500.gif",
      "http://24.media.tumblr.com/5cfb4463a5b7484d7cdbdcb61271c495/tumblr_mpylwuRedl1qfjvexo1_500.gif",
      "http://25.media.tumblr.com/fc9b9d47fe285620b55b237834d63d08/tumblr_mlgbscgSMu1qfjvexo1_500.gif",
      "http://31.media.tumblr.com/bf994f4769819676dabae3452e5d126c/tumblr_mk8v5qxfZe1qfjvexo1_500.gif",
      "http://24.media.tumblr.com/5e911cb45795fee8d59f83d62cfcbbfc/tumblr_mfmk4lREqB1qfjvexo1_500.gif",
      "http://25.media.tumblr.com/tumblr_me70b6T4Nx1qfjvexo1_500.gif",
      "http://24.media.tumblr.com/tumblr_mdv6wykYMz1qfjvexo1_500.gif",
      "http://24.media.tumblr.com/tumblr_ma28naYTFd1qfjvexo1_500.gif",
      "http://24.media.tumblr.com/tumblr_m6q28aZ30c1qfjvexo1_500.gif",
      "http://31.media.tumblr.com/tumblr_m631bmEnX51qfjvexo1_500.gif",
      "http://25.media.tumblr.com/tumblr_m6eu89zSRs1rpmo4ho1_500.gif", //http://challenger23.com/post/50172533016/higher-higher-hard-to-believe-its-been-a
      "http://24.media.tumblr.com/tumblr_m8jk6nInJO1qzt4vjo1_r1_500.gif", //http://dvdp.tumblr.com/post/29122608238/120810
      "http://24.media.tumblr.com/e5c932db66ed421736780dfebbe35526/tumblr_mkpeswN0251qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/47063729566/130404-love-you-all
      "http://25.media.tumblr.com/05f77e427b084ca9c12e7988820db96f/tumblr_mjtrxqSygR1qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/45622098355/130317-so-i-had-unbelievable-strong-feelings-for
      "http://25.media.tumblr.com/aefa86d4b95da7575f624c2cf8a6c027/tumblr_mjehov9lbc1qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/44944654275/130309-few-words-0-i-lied-in-my-last-post
      "http://25.media.tumblr.com/tumblr_m80rq1nhi01qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/28403235902/120731
      "http://24.media.tumblr.com/tumblr_m0fn8ixvDc1qzt4vjo1_r2_500.gif", //http://dvdp.tumblr.com/post/18809736612/120305-xxl
      "http://25.media.tumblr.com/tumblr_lxuxdsMuKY1qzt4vjo1_r2_500.gif", //http://dvdp.tumblr.com/post/15902554993/120115
      "http://25.media.tumblr.com/tumblr_ltljrwYaPG1qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/11888038945/111025
      "http://31.media.tumblr.com/tumblr_lfiabnq4ec1qzt4vjo1_r1_500.gif", //http://dvdp.tumblr.com/post/2903000638/110124
      "http://25.media.tumblr.com/tumblr_lc8pjaHh731qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/1637287002
      "http://25.media.tumblr.com/tumblr_l99apcLI5U1qzt4vjo1_r1_500.gif", //http://dvdp.tumblr.com/post/1179162945
      "http://24.media.tumblr.com/tumblr_l6livgwj781qzt4vjo1_r1_500.gif", //http://dvdp.tumblr.com/post/899742508
      "http://25.media.tumblr.com/tumblr_kt0pplLYZc1qzt4vjo1_500.gif", //http://dvdp.tumblr.com/post/241884041
      "http://24.media.tumblr.com/dd6144cd30249268266d4b69398df2e3/tumblr_n02sq2Tfre1r2geqjo1_500.gif", //http://beesandbombs.tumblr.com/post/74749253172/this-is-a-gif-i-posted-a-few-weeks-ago-if-you

    ];

    var OVERLAY_URLS = [
      "http://25.media.tumblr.com/b93b52e9f704e89ea5721398ba762fc3/tumblr_mmlorl6uJk1s5jjtzo1_500.png", //http://totallytransparent.tumblr.com/post/73656808043/totallytransparent-transparent-salvador-dalis
      "http://24.media.tumblr.com/3c3ded128ce8179e6338012392de9021/tumblr_mzx1poQmV71s5jjtzo1_500.gif", //http://totallytransparent.tumblr.com/post/74401902373/transparent-kissing-gif-sort-of-semi
      "http://24.media.tumblr.com/e48fe0368f01d20e5b1dcc3b66e6a070/tumblr_mzhum4TSai1s5jjtzo1_500.gif", //http://totallytransparent.tumblr.com/post/73541531280/transparent-eye-gif-iris-matches-colour-of-your
      "http://31.media.tumblr.com/c6b4a7e7e8595f35ca5f9f3ed5040913/tumblr_mz5q82frU91s5jjtzo1_500.png", //http://totallytransparent.tumblr.com/post/72809125006/semi-transparent-glass-smash-makes-your-blog-look
      "http://31.media.tumblr.com/dd068196666b46e5a8fd3bd6c9eac3c0/tumblr_mz07y9yFah1s5jjtzo1_1280.png", //http://totallytransparent.tumblr.com/post/72491298811/semi-transparent-ice-cream-rose-matches-colour-of
      "http://24.media.tumblr.com/f2c3cb58e5df9b083bb4db24bf7f065a/tumblr_mney5aJkmu1s5jjtzo1_r1_500.gif", //http://totallytransparent.tumblr.com/post/71767033740/totallytransparent-transparent-fireworks-gif
      "http://25.media.tumblr.com/bd38c3f264f51c1043b6c20d64c20a26/tumblr_mxgcbshJ4H1s5jjtzo1_500.gif", //http://totallytransparent.tumblr.com/post/69294181178/transparent-water-gif-your-blogs-background-is
      "http://25.media.tumblr.com/16791f385d1f17007371db57f655a0fb/tumblr_mqnsgg4DG21s5jjtzo1_500.png", //http://totallytransparent.tumblr.com/post/66791599192/totallytransparent-transparent-tiger-wading
      "http://24.media.tumblr.com/85535e0b10eec06ec3a953735b42ca22/tumblr_mvebyknAzU1s5jjtzo1_500.png", //http://totallytransparent.tumblr.com/post/65475977299/semi-transparent-lips-match-colour-of-your-blog
      "http://25.media.tumblr.com/98ee332435883155967ec37571a96e89/tumblr_mtygnj0ELN1s5jjtzo1_500.gif", //http://totallytransparent.tumblr.com/post/62742418730/transparent-lipgloss-gif-lipgloss-matches-colour
      "http://25.media.tumblr.com/d6360c046a650cc74690ae742e1a9c97/tumblr_msvaa9dfPZ1s5jjtzo1_r1_500.gif", //http://totallytransparent.tumblr.com/post/60768502030/transparent-dandelion-gif-dandelion-matches
      "http://25.media.tumblr.com/888e68096bf9c50a9c1d16335ce54003/tumblr_mstvtvgioJ1s5jjtzo1_1280.png", //http://totallytransparent.tumblr.com/post/60695536443/semi-transparent-hair-matches-colour-of-your
      "http://31.media.tumblr.com/0dd2c6d14ce9eb15dca0ec7193669a88/tumblr_msd2dkG47M1s5jjtzo1_500.png", //http://totallytransparent.tumblr.com/post/59799200631/semi-transparent-roses-petals-match-colour-of
      "http://24.media.tumblr.com/e26e2f10a4399fa6402bef117ae6b3e6/tumblr_mpkl8sCbQs1s5jjtzo1_500.gif", //http://totallytransparent.tumblr.com/post/56912764887/totallytransparent-drawn-animated-by-totally
    ]

    var gif_index_min = 0;
    var gif_index_max = GIF_URLS.length-1;

    var overlay_index_min = 0;
    var overlay_index_max = OVERLAY_URLS.length-1;

    var translate_interval;

    //var percent = DEFAULT_PERCENT;
    var hpercent = DEFAULT_PERCENT;
    var vpercent = DEFAULT_PERCENT;


    function init() {
      container = document.getElementById("container");
      rawr = document.getElementById("rawr");
      overlay = document.getElementById("overlay");

      setListGif();

      container.onmouseover = function() {
        
        var inner = document.getElementById("controls");
        inner.classList.add("hover");
        
      };

      container.onmouseout = function() {
        var inner = document.getElementById("controls");
        inner.classList.remove("hover");
      };

    }

    function setManualGif() {
      url = document.getElementById("area").value;

      GIF_URLS.push(url);
      gif_index_max = GIF_URLS.length-1;

      rawr.style.backgroundImage = "url("+url+")";
      setBackgroundImageFromUrl(rawr, url);
    }

    function setListGif() {
      setBackgroundImageFromUrl(rawr, GIF_URLS[gif_index]);
    }

    function setListOverlay() {
      setBackgroundImageFromUrl(overlay, OVERLAY_URLS[overlay_index]);
    }

    function setBackgroundImageFromUrl(e, url) {
      e.style.backgroundImage = "url("+url+")";
    }

    function minus() {
      hpercent *= (1 - PERCENT_STEP);
      vpercent *= (1 - PERCENT_STEP);
      set_backgroundSize(hpercent, vpercent);
    }

    function plus() {
      hpercent *= (1 + PERCENT_STEP);
      vpercent *= (1 + PERCENT_STEP);
      set_backgroundSize(hpercent, vpercent);
    }

    function horiz() {
      set_backgroundSize("100%", vpercent);
    }

    function verti() {
      set_backgroundSize(hpercent, "100%");
    }

    function full() {
      set_backgroundSize("100%", "100%");
    }

    function set_backgroundSize(hpercent, vpercent) {
      rawr.style.backgroundSize = ""+hpercent+"% "+vpercent+"%";
    }

    function next_gif() {
      if (gif_index < gif_index_max){
        gif_index++;
      } else {
        gif_index = gif_index_min;
      }

      setListGif();
    }

    function prev_gif() {
      if (gif_index > gif_index_min){
        gif_index--;
      } else {
        gif_index = gif_index_max;
      }

      setListGif();
    }

    function next_overlay() {
      if (overlay_index < overlay_index_max){
        overlay_index++;
      } else {
        overlay_index = overlay_index_min;
      }

      setListOverlay();
    }

    function prev_overlay() {
      if (overlay_index > overlay_index_min){
        overlay_index--;
      } else {
        overlay_index = overlay_index_max;
      }

      setListOverlay();
    }

    function nozoom() {
      rawr.style.backgroundSize = "";

      tracking = false;
      stopmovingit();

      x = DEFAULT_X;
      y = DEFAULT_Y;

      dx = DEFAULT_DX;
      dy = DEFAULT_DY;

      hpercent = DEFAULT_PERCENT;
      vpercent = DEFAULT_PERCENT;

      drawxy();
    }

    function drawxy() {
      // This is a bit of a misnomer, nothing is really being "drawn" but it makes sense kind of
      draw(x,y);
    }

    function draw(_x,_y) {
        rawr.style.backgroundPositionY = _y+"px";
        rawr.style.backgroundPositionX = _x+"px";      
    }

    function moveit() {
      moving = true;

      if (translate_interval){
        dx *= 1.5;
        dy *= 1.5;
      } else {
        translate_interval = window.setInterval(function(){
          if (moving){
            x += dx; 
            y += dy; 
            drawxy();
          }
        }, dt);
      }
    }

    function toggleoverlay() {
      toggle_visibility("overlay");
    }

    function stopmovingit() {
      clearInterval(translate_interval);
      moving = false;
      translate_interval = null;
    }

    function trackit() {
      tracking = !tracking;
    }

  </script>

  <script type="text/javascript">
  <!--
  //http://blog.movalog.com/a/javascript-toggle-visibility/
  // Grab display from computed style then write it to the element's style
      function toggle_visibility(id) {
         var e = document.getElementById(id);
         var display = window.getComputedStyle(e).display
         if( display == 'block')
            e.style.display = 'none';
         else
            e.style.display = 'block';
      }
  //-->
  </script>
  <script>
    var key_function_mappings = {
      "M" : moveit,
      "S" : stopmovingit,
      "T" : trackit,
      "N" : next_gif,
      "P" : prev_gif,
      "H" : horiz,
      "V" : verti,
      "F" : full,
      "0" : nozoom,
      "O" : toggleoverlay,
      "%" : function() { dx /= 1.5; drawxy(); }, // left arrow
      "'" : function() { dx *= 1.5; drawxy(); }, // right arrow
      "(" : function() { dy *= 1.5; drawxy(); }, // up arrow
      "&" : function() { dy /= 1.5; drawxy(); }, // down arrow
      187 : plus,  // This is stupid. (-)
      189 : minus, // This is stupid. (=)
      219 : prev_overlay, // This is stupid. ([)
      221 : next_overlay, // This is stupid. (])
    };

    function keystroke(e){
      if (document.activeElement == document.getElementById("area")){
        return;
      }
      // High ascii is being all shitty so this tries to look up codes if it can't find the character.
      keyChar = String.fromCharCode(e.keyCode);
      if ( key_function_mappings.hasOwnProperty(keyChar) ){
        key_function_mappings[keyChar]();
      } else if (key_function_mappings.hasOwnProperty(e.keyCode)) {
        key_function_mappings[e.keyCode]();
      }
    }

    function mousemove(e){
      if (tracking){
        y = e.y;
        x = e.x; 
        drawxy();
      }
    }

  </script>
</head>

<body 
  onload="init();"
  onkeydown=keystroke(event)
  onmousemove=mousemove(event)>
  <div
  class="full"
  id="rawr" 
  style="background-image: url('http://upload.wikimedia.org/wikipedia/commons/4/42/Loading.gif'); background-color: black"
 >
   <div
  class="full hidable"
  id="overlay" 
  style="background-image: url('http://24.media.tumblr.com/f2c3cb58e5df9b083bb4db24bf7f065a/tumblr_mney5aJkmu1s5jjtzo1_r1_500.gif');
  background-size: 100% 100%;
  "
 >
 
    <div id="container">
      <div class="hidden" id="controls">
        <textarea id="area" onchange="setManualGif()" onTextEntered="setManualGif()"></textarea>
        <br>
        <button id="next" onclick="next_gif()">Next gif (N)</button>
        <button id="prev" onclick="prev_gif()">Previous gif (P)</button>
        <br>
        <button id="minus" onclick="minus()">Zoom out (-)</button>
        <button id="plus" onclick="plus()">Zoom in (+)</button>
        <button id="nozoom" onclick="nozoom()">No Zoom (0)</button>
        <br>
        <button id="horiz" onclick="horiz()">Horz (H)</button>
        <button id="verti" onclick="verti()">Vert (V)</button>
        <button id="full" onclick="full()">Full (F)</button>
        <br>
        <button id="moveit" onclick="moveit()">Move It (M)</button>
        <button id="stopit" onclick="stopmovingit()">Stop it (S)</button>
        <br>
        <button id="trackit" onclick="trackit()">Toggle Mouse Tracking (T)</button>
        <br>
        <button id="toggleoverlay" onclick="toggleoverlay()">Toggle Overlay (O)</button>
        <button id="Prevoverlay" onclick="Prev_overlay()">Previous Overlay ([)</button> 
        <button id="nextoverlay" onclick="next_overlay()">Next Overlay (])</button>
      </div>
    </div>
  </div>
</body>
</html>
